# P07-地图组件生成提示词（通用版）

> **📌 用途**: 生成ECharts地图组件，用于展示地理数据分布和区域对比。

---

## 🎭 R - 角色定义

你是一位资深数据可视化工程师，拥有8年ECharts/D3.js开发经验，擅长：

- ECharts地图图表开发
- 地理数据可视化
- GeoJSON数据处理
- 地图交互设计

---

## 📋 T - 任务描述

基于以下需求，生成地图（Map）组件。

### 输入材料

#### 材料1：组件需求

```
【组件名称】{填写组件名称，如"用户分布地图"}

【地图范围】
- 地图类型：{中国地图/省级地图/世界地图/自定义}
- 具体区域：{全国/某省/某市}
- GeoJSON来源：{内置/外部URL/本地文件}

【视觉效果】
- 尺寸：{宽度}px × {高度}px
- 区域填充：{渐变色/分段色}，范围{最小色}-{最大色}
- 边界线：颜色{边界色}，宽度{边界宽度}px
- 背景色：{地图背景色}

【数据展示】
- 数据类型：{区域着色/气泡标注/热力图}
- 气泡大小：{固定/按数值缩放}
- 标签显示：{区域名称/数值/隐藏}

【交互效果】
- Hover：{区域高亮/显示Tooltip}
- 点击：{下钻/触发事件}
- 缩放：{支持/不支持}
- 拖拽：{支持/不支持}

【数据结构】
{
  data: {
    name: string,         // 区域名称（需与GeoJSON匹配）
    value: number,        // 数值
    coord?: [number, number]  // 经纬度（气泡标注用）
  }[]
}
```

#### 材料2：技术要求

```
- 框架：{Vue 3/React 18}
- 图表库：{ECharts 5/其他}
- GeoJSON注册：{echarts.registerMap}
- 样式：使用设计系统CSS变量
```

### 任务上下文

{描述组件的使用场景，如"用于展示全国各省用户分布，支持点击省份查看详情"}

---

## 🎯 G - 目标与意图

### 核心目标

生成一个**区域清晰、数据直观、交互流畅**的地图组件，展示地理数据分布。

### 具体目标

1. **区域清晰**: 地图边界清晰，区域可识别
2. **数据直观**: 颜色深浅或气泡大小反映数据量级
3. **交互流畅**: 支持缩放、拖拽、下钻等交互
4. **可扩展**: 支持切换不同地图范围

### 业务价值

- **为业务人员**: 直观了解地域分布，发现区域差异
- **为管理层**: 区域对比分析，辅助区域策略制定
- **为开发团队**: 可复用地图组件，减少重复开发

### 成功标准

- ✅ 地图区域与GeoJSON数据正确匹配
- ✅ 数据值与颜色深浅正相关
- ✅ 支持省份下钻（可选）
- ✅ 代码包含完整TypeScript类型定义

---

## 📤 O - 输出要求

### 1. 输出结构

```
src/components/charts/
├── MapChart.vue           # 地图组件
├── MapChart.types.ts      # 类型定义
├── useMapChart.ts         # 组合式函数（图表逻辑）
└── geoData/               # GeoJSON数据（可选）
    └── china.json
```

### 2. 质量要求

#### 代码规范
- Props使用 `defineProps<T>()` 泛型定义
- GeoJSON异步加载，避免打包体积过大
- 支持自定义tooltip内容

#### 性能规范
- GeoJSON数据缓存，避免重复加载
- 使用 `ResizeObserver` 监听容器变化
- 大量气泡点使用scatter替代effectScatter

### 3. 格式规范

- ECharts配置项分离到单独函数
- 颜色使用设计系统定义

### 4. 特别说明

#### GeoJSON加载与注册

```typescript
const loadMapData = async (mapName: string) => {
  // 检查缓存
  if (echarts.getMap(mapName)) return
  
  // 加载GeoJSON
  const response = await fetch(`/geo/${mapName}.json`)
  const geoJson = await response.json()
  
  // 注册地图
  echarts.registerMap(mapName, geoJson)
}
```

#### 区域着色配置

```typescript
const getVisualMap = (min: number, max: number) => ({
  visualMap: {
    type: 'continuous',
    min,
    max,
    inRange: {
      color: ['var(--color-map-min)', 'var(--color-map-max)']
    },
    text: ['高', '低'],
    calculable: true
  }
})
```

#### 下钻实现

```typescript
const handleMapClick = async (params: ECElementEvent) => {
  const regionName = params.name
  // 加载子区域地图
  await loadMapData(regionName)
  // 切换地图显示
  chartInstance.value?.setOption({
    geo: { map: regionName }
  })
  emit('drill-down', regionName)
}
```

---

## ✨ 输出格式

直接输出完整的Vue组件代码，包含类型定义和组合式函数。
