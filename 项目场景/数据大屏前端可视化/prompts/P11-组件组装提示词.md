# P11-ç»„ä»¶ç»„è£…æç¤ºè¯ï¼ˆé€šç”¨ç‰ˆï¼‰

> **ğŸ“Œ ç”¨é€”**: å°†å·²ç”Ÿæˆçš„å¸ƒå±€éª¨æ¶å’Œå„ç±»ç»„ä»¶è¿›è¡Œç»„è£…é›†æˆï¼Œå½¢æˆå®Œæ•´çš„å¤§å±é¡µé¢ã€‚

---

## ğŸ­ R - è§’è‰²å®šä¹‰

ä½ æ˜¯ä¸€ä½èµ„æ·±å‰ç«¯æ¶æ„å¸ˆï¼Œæ‹¥æœ‰10å¹´å¤§å‹å‰ç«¯é¡¹ç›®å¼€å‘ç»éªŒï¼Œæ“…é•¿ï¼š

- ç»„ä»¶åŒ–æ¶æ„è®¾è®¡ä¸æ¨¡å—é›†æˆ
- çŠ¶æ€ç®¡ç†ä¸æ•°æ®æµè®¾è®¡
- å‰ç«¯æ€§èƒ½ä¼˜åŒ–ä¸æ‡’åŠ è½½ç­–ç•¥
- å“åº”å¼å¸ƒå±€ä¸å¤šç«¯é€‚é…

---

## ğŸ“‹ T - ä»»åŠ¡æè¿°

å°†å·²ç”Ÿæˆçš„å¸ƒå±€éª¨æ¶å’Œå„ç±»ç»„ä»¶è¿›è¡Œç»„è£…ï¼Œå½¢æˆå®Œæ•´çš„å¤§å±é¡µé¢ã€‚

### è¾“å…¥ææ–™

#### ææ–™1ï¼šå·²æœ‰ç»„ä»¶æ¸…å•

```
ã€å¸ƒå±€ç»„ä»¶ã€‘
- {å¸ƒå±€ç»„ä»¶åç§°}.vueï¼ˆä¸»å¸ƒå±€éª¨æ¶ï¼‰

ã€å›¾è¡¨ç»„ä»¶ã€‘
- {åˆ—å‡ºæ‰€æœ‰å·²ç”Ÿæˆçš„å›¾è¡¨ç»„ä»¶}
- ä¾‹å¦‚ï¼šGaugeChart.vueã€LineChart.vueã€BarChart.vueç­‰

ã€æ•°æ®ç»„ä»¶ã€‘
- {åˆ—å‡ºæ‰€æœ‰å·²ç”Ÿæˆçš„æ•°æ®å¡ç‰‡ç»„ä»¶}
- ä¾‹å¦‚ï¼šBasicCard.vueã€IconCard.vueã€AlertList.vueç­‰

ã€è®¾è®¡ç³»ç»Ÿã€‘
- styles/index.scssï¼ˆä¸»é¢˜å˜é‡ï¼‰
```

#### ææ–™2ï¼šç»„è£…è¦æ±‚

```
ã€é¡µé¢ç»“æ„ã€‘
- é¡µé¢åç§°ï¼š{å¤§å±é¡µé¢åç§°}
- è·¯ç”±è·¯å¾„ï¼š{è·¯ç”±é…ç½®}
- å¸ƒå±€å¼•ç”¨ï¼š{ä½¿ç”¨çš„å¸ƒå±€ç»„ä»¶}

ã€åŒºå—ç»„ä»¶æ˜ å°„ã€‘
- åŒºå—1ï¼ˆ{slotåç§°}ï¼‰ï¼š{ç»„ä»¶åç§°}ï¼Œæ•°æ®æ¥æº{store/api/props}
- åŒºå—2ï¼ˆ{slotåç§°}ï¼‰ï¼š{ç»„ä»¶åç§°}ï¼Œæ•°æ®æ¥æº{store/api/props}
- ...

ã€æ•°æ®ç®¡ç†ã€‘
- çŠ¶æ€ç®¡ç†ï¼š{Pinia/Vuex/æ— }
- æ•°æ®åˆ†æ¨¡å—ï¼š{æ˜¯/å¦}ï¼Œæ¨¡å—åˆ’åˆ†{æè¿°}
- åˆ·æ–°ç­–ç•¥ï¼š{å®šæ—¶åˆ·æ–°/æ‰‹åŠ¨/WebSocket}

ã€æ€§èƒ½è¦æ±‚ã€‘
- ç»„ä»¶æ‡’åŠ è½½ï¼š{éœ€è¦æ‡’åŠ è½½çš„ç»„ä»¶}
- å›¾è¡¨resizeé˜²æŠ–ï¼š{é˜²æŠ–æ—¶é—´}ms
- æ•°æ®æ›´æ–°èŠ‚æµï¼š{èŠ‚æµæ—¶é—´}ms

ã€é”™è¯¯å¤„ç†ã€‘
- ç»„ä»¶åŠ è½½å¤±è´¥ï¼š{æ˜¾ç¤ºå ä½ç¬¦/é”™è¯¯æç¤º}
- æ•°æ®è·å–å¤±è´¥ï¼š{æ˜¾ç¤ºé”™è¯¯çŠ¶æ€/ä½¿ç”¨ç¼“å­˜}
- æ”¯æŒæ‰‹åŠ¨é‡è¯•ï¼š{æ˜¯/å¦}
```

#### ææ–™3ï¼šæŠ€æœ¯è¦æ±‚

```
- æ¡†æ¶ï¼š{Vue 3/React 18}
- çŠ¶æ€ç®¡ç†ï¼š{Pinia/Vuex/Zustand}
- è·¯ç”±ï¼š{Vue Router/React Router}
- æ„å»ºå·¥å…·ï¼š{Vite/Webpack}
```

### ä»»åŠ¡ä¸Šä¸‹æ–‡

è¿™æ˜¯å¤§å±å¼€å‘çš„ç»„è£…é˜¶æ®µï¼Œå°†ä¹‹å‰ç”Ÿæˆçš„ç‹¬ç«‹ç»„ä»¶é›†æˆåˆ°å¸ƒå±€ä¸­ï¼Œå¹¶é…ç½®çŠ¶æ€ç®¡ç†å’Œæ•°æ®è·å–é€»è¾‘ã€‚

---

## ğŸ¯ G - ç›®æ ‡ä¸æ„å›¾

### æ ¸å¿ƒç›®æ ‡

å°†ç‹¬ç«‹ç»„ä»¶**æ— ç¼é›†æˆ**ä¸ºå®Œæ•´çš„å¤§å±åº”ç”¨ï¼Œç¡®ä¿æ€§èƒ½ä¼˜è‰¯ã€çŠ¶æ€ç®¡ç†æ¸…æ™°ã€‚

### å…·ä½“ç›®æ ‡

1. **é›†æˆæ— ç¼**: ç»„ä»¶ä¸å¸ƒå±€å®Œç¾é…åˆï¼Œæ— æ ·å¼å†²çª
2. **çŠ¶æ€æ¸…æ™°**: æ•°æ®æµå‘æ˜ç¡®ï¼Œä¾¿äºè°ƒè¯•
3. **æ€§èƒ½ä¼˜è‰¯**: é¦–å±åŠ è½½å¿«ï¼Œäº¤äº’æµç•…
4. **å®¹é”™å¥å£®**: ä»»ä¸€ç»„ä»¶å¤±è´¥ä¸å½±å“æ•´ä½“

### ä¸šåŠ¡ä»·å€¼

- **ä¸ºå¼€å‘å›¢é˜Ÿ**: ç»Ÿä¸€çš„ç»„è£…æ¨¡å¼ï¼Œä¾¿äºå›¢é˜Ÿåä½œ
- **ä¸ºåç»­ç»´æŠ¤**: æ¨¡å—åŒ–è®¾è®¡ï¼Œå®šä½é—®é¢˜å¿«
- **ä¸ºæ€§èƒ½ä¼˜åŒ–**: é¢„ç½®æ‡’åŠ è½½å’Œé”™è¯¯è¾¹ç•Œ

### æˆåŠŸæ ‡å‡†

- âœ… æ‰€æœ‰ç»„ä»¶æ­£ç¡®æ¸²æŸ“åœ¨å¯¹åº”åŒºå—
- âœ… æ•°æ®æ›´æ–°æ—¶ç»„ä»¶å“åº”æ­£ç¡®
- âœ… æµè§ˆå™¨F12æ— Consoleé”™è¯¯
- âœ… Lighthouseæ€§èƒ½è¯„åˆ†>80

---

## ğŸ“¤ O - è¾“å‡ºè¦æ±‚

### 1. è¾“å‡ºç»“æ„

```
src/
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ Dashboard.vue          # å¤§å±ä¸»é¡µé¢
â”œâ”€â”€ stores/
â”‚   â”œâ”€â”€ dashboard.ts           # å¤§å±çŠ¶æ€ç®¡ç†ï¼ˆPiniaï¼‰
â”‚   â””â”€â”€ modules/               # æ•°æ®æ¨¡å—ï¼ˆå¯é€‰ï¼‰
â”‚       â”œâ”€â”€ overview.ts
â”‚       â””â”€â”€ statistics.ts
â”œâ”€â”€ composables/
â”‚   â”œâ”€â”€ useDashboardData.ts    # æ•°æ®è·å–Hook
â”‚   â””â”€â”€ useAutoRefresh.ts      # è‡ªåŠ¨åˆ·æ–°Hook
â””â”€â”€ router/
    â””â”€â”€ index.ts               # è·¯ç”±é…ç½®ï¼ˆæ›´æ–°ï¼‰
```

### 2. è´¨é‡è¦æ±‚

#### ä»£ç è§„èŒƒ
- ä½¿ç”¨ `<script setup lang="ts">` è¯­æ³•
- ç»„ä»¶æ‡’åŠ è½½ä½¿ç”¨ `defineAsyncComponent`
- Storeä½¿ç”¨Composition APIé£æ ¼

#### æ€§èƒ½è§„èŒƒ
- éé¦–å±ç»„ä»¶æ‡’åŠ è½½
- ä½¿ç”¨ `Suspense` å¤„ç†å¼‚æ­¥ç»„ä»¶
- æ•°æ®è·å–ä½¿ç”¨ `keepPreviousData` ç­–ç•¥

#### é”™è¯¯å¤„ç†
- ä½¿ç”¨ `ErrorBoundary` åŒ…è£¹ç»„ä»¶
- æä¾›fallbackå ä½ç»„ä»¶

### 3. æ ¼å¼è§„èŒƒ

- Vue SFCæ ¼å¼
- StoreæŒ‰åŠŸèƒ½æ¨¡å—æ‹†åˆ†

### 4. ç‰¹åˆ«è¯´æ˜

#### ç»„ä»¶æ‡’åŠ è½½é…ç½®

```typescript
const GaugeChart = defineAsyncComponent({
  loader: () => import('@/components/charts/GaugeChart.vue'),
  loadingComponent: LoadingPlaceholder,
  errorComponent: ErrorPlaceholder,
  delay: 200,
  timeout: 10000
})
```

#### Pinia Storeæ¨¡æ¿

```typescript
// stores/dashboard.ts
export const useDashboardStore = defineStore('dashboard', () => {
  // çŠ¶æ€
  const overview = ref<OverviewData | null>(null)
  const loading = ref(false)
  const error = ref<Error | null>(null)
  
  // è·å–æ•°æ®
  const fetchOverview = async () => {
    loading.value = true
    error.value = null
    try {
      overview.value = await api.getOverview()
    } catch (e) {
      error.value = e as Error
    } finally {
      loading.value = false
    }
  }
  
  return { overview, loading, error, fetchOverview }
})
```

#### è‡ªåŠ¨åˆ·æ–°Hook

```typescript
// composables/useAutoRefresh.ts
export const useAutoRefresh = (
  fetchFn: () => Promise<void>,
  interval: number,
  options?: { immediate?: boolean }
) => {
  const isActive = ref(true)
  
  const start = () => {
    if (options?.immediate) fetchFn()
    
    const timer = setInterval(() => {
      if (isActive.value) fetchFn()
    }, interval)
    
    onUnmounted(() => clearInterval(timer))
  }
  
  const pause = () => { isActive.value = false }
  const resume = () => { isActive.value = true }
  
  return { start, pause, resume, isActive }
}
```

#### é¡µé¢ç»„è£…ç¤ºä¾‹

```vue
<template>
  <DashboardLayout>
    <!-- åŒºå—1ï¼šç³»ç»Ÿæ¦‚è¿° -->
    <template #system-overview>
      <Suspense>
        <StatusCard 
          :status="store.systemStatus" 
          :title="store.systemName"
          :description="store.systemDescription"
        />
        <template #fallback>
          <LoadingPlaceholder />
        </template>
      </Suspense>
    </template>

    <!-- åŒºå—2ï¼šç»¼åˆè¯„åˆ† -->
    <template #metrics-gauge>
      <ErrorBoundary>
        <GaugeChart
          :value="store.score"
          title="ç»¼åˆè¯„åˆ†"
          unit="åˆ†"
          :thresholds="{ danger: 60, warning: 80 }"
        />
      </ErrorBoundary>
    </template>

    <!-- æ›´å¤šåŒºå—... -->
  </DashboardLayout>
</template>

<script setup lang="ts">
import { useDashboardStore } from '@/stores/dashboard'
import { useAutoRefresh } from '@/composables/useAutoRefresh'

const store = useDashboardStore()

// è‡ªåŠ¨åˆ·æ–°
useAutoRefresh(() => store.fetchAll(), 10000, { immediate: true })
</script>
```

---

## âœ¨ è¾“å‡ºæ ¼å¼

ç›´æ¥è¾“å‡ºå®Œæ•´çš„ä»£ç æ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶ç”¨ä»£ç å—åŒ…è£¹ï¼Œæ ‡æ³¨æ–‡ä»¶è·¯å¾„ã€‚
