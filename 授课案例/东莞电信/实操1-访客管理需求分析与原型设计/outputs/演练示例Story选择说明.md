# 演练示例Story选择说明

## 选择的Story：US-002 - 访客查询预约记录

### 选择理由

从10个用户故事中，我选择 **US-002（访客查询预约记录）** 作为演练示例，原因如下：

#### 1. **复杂度适中** ⭐⭐⭐（3星/5星）

- **故事点**: 3点（2-3天完成）
- **技术复杂度**: 中等
  - 涉及查询接口（GET）
  - 支持分页和筛选
  - 响应数据结构相对简单
- **业务复杂度**: 较低
  - 查询逻辑清晰，无复杂业务规则
  - 不涉及状态变更或第三方集成
  - 验收标准明确可测

**对比**：
- US-001（提交预约）：太复杂，涉及文件上传、实名验证、微信推送
- US-003（取消预约）：过于简单，只有1个主要接口

#### 2. **API设计典型性** ✅

US-002涵盖RESTful API设计的典型模式：

| API设计要素 | US-002覆盖情况 |
|------------|---------------|
| 查询列表接口 | ✅ GET /api/appointments（分页） |
| 查询详情接口 | ✅ GET /api/appointments/{id} |
| 查询参数 | ✅ Query参数（status、startDate、endDate、page、pageSize） |
| 响应分页 | ✅ 分页响应（items + pagination） |
| 筛选器 | ✅ 按状态、时间范围筛选 |
| 错误处理 | ✅ 404资源不存在、401未授权 |

**适合演示**：
- RESTful资源命名（/appointments）
- 分页设计（page + pageSize + total）
- 查询参数设计（筛选 + 排序）
- 响应数据结构设计（统一格式）

#### 3. **测试用例丰富性** ✅

US-002可生成多样化的测试用例：

```
测试用例类型覆盖：
├─ ✅ 成功场景（正常查询）
│   ├─ 查询列表（默认分页）
│   ├─ 查询列表（指定页码和大小）
│   └─ 查询详情（指定ID）
├─ ❌ 参数验证
│   ├─ page为0（边界值）
│   ├─ page为字符串（类型错误）
│   ├─ pageSize超过100（边界值）
│   └─ 日期格式错误
├─ ❌ 业务逻辑
│   ├─ 查询不存在的ID（404）
│   └─ 查询他人的预约（403）
├─ ❌ 认证授权
│   └─ 未登录访问（401）
└─ ⚠️ 边界场景
    ├─ 空结果集（无预约记录）
    └─ 大数据量（1000+条记录分页）
```

**测试覆盖率**: 可生成8-10个测试用例，覆盖5类场景

#### 4. **独立性强** ✅

- **依赖关系**: 仅依赖US-001（预约数据存在）
- **无外部集成**: 不依赖门禁系统、微信推送等第三方服务
- **可单独演示**: 可通过Mock数据独立演示，无需完整环境

#### 5. **教学价值高** 🎓

US-002适合教学的原因：

| 教学点 | 说明 |
|--------|------|
| RESTful最佳实践 | 演示GET请求、资源命名、HTTP状态码使用 |
| 分页设计模式 | page/pageSize/total标准分页响应 |
| 查询参数设计 | 筛选器（status）、时间范围（startDate/endDate）的API设计 |
| OpenAPI规范 | 典型的查询接口OpenAPI定义（parameters + responses） |
| 测试用例设计 | 覆盖正常、异常、边界的完整测试用例集 |
| 前后端协作 | 前端列表组件与API对接的标准范式 |

#### 6. **扩展性好** 🔧

从US-002可自然扩展到其他查询场景：

```
US-002基础查询
  ├─ 扩展1：高级搜索（关键词、模糊匹配）
  ├─ 扩展2：排序功能（按时间、状态排序）
  ├─ 扩展3：导出功能（导出Excel）
  └─ 扩展4：聚合统计（查询+统计）
```

---

## 演练计划

### 步骤1：基于US-002生成API接口设计文档

**使用提示词**: 07-API接口设计提示词.md

**输入材料**:
```
用户故事：US-002 - 访客查询预约记录
（完整内容见上文）
```

**预期输出**:
```markdown
# 访客预约记录查询API接口设计

## 1. 接口清单
| 接口名称 | 路径 | 方法 | 功能描述 |
|---------|------|------|---------|
| 查询预约列表 | /api/v1/appointments | GET | 分页查询访客预约记录 |
| 查询预约详情 | /api/v1/appointments/{id} | GET | 查询指定预约详情 |

## 2. 接口详细设计

### 2.1 查询预约列表

#### 基本信息
- 接口名称：查询预约列表
- 接口路径：/api/v1/appointments
- 请求方法：GET
- 认证方式：Bearer Token（JWT）

#### 请求参数
...（完整API设计）
```

---

### 步骤2：基于API设计生成OpenAPI文档

**使用提示词**: 08-OpenAPI文档生成提示词.md

**预期输出**:
```yaml
openapi: 3.0.3
info:
  title: 访客预约记录查询API
  version: 1.0.0

paths:
  /api/v1/appointments:
    get:
      summary: 查询预约列表
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
      ...
```

---

### 步骤3：基于OpenAPI生成接口测试用例

**使用提示词**: 09-接口测试用例生成提示词.md

**预期输出**:
```json
{
  "info": {
    "name": "访客预约记录查询API测试用例集"
  },
  "item": [
    {
      "name": "查询预约列表",
      "item": [
        {
          "name": "✅ 成功场景 - 查询第1页数据",
          "request": {...},
          "event": [...]
        },
        ...
      ]
    }
  ]
}
```

---

## 对比：为什么不选其他Story？

### ❌ US-001（访客提交预约）

**不选原因**：
- 太复杂：涉及文件上传、实名验证、微信推送、黑名单校验
- API设计点过多：POST请求、multipart/form-data、异步处理
- 测试用例太多：需要20+个测试用例才能覆盖充分
- 外部依赖：依赖微信OAuth、实名验证接口、微信模板消息

**适合场景**：完整项目演练（需要2-3天）

---

### ❌ US-003（取消预约）

**不选原因**：
- 过于简单：只有1个PUT接口
- 业务逻辑单一：状态更新 + 通知推送
- API设计点少：缺少分页、筛选等复杂查询场景
- 测试用例少：只能生成4-5个测试用例

**适合场景**：快速入门演练（1小时）

---

### ❌ US-004/US-005（审批流程）

**不选原因**：
- 依赖US-001：必须先有预约数据
- 业务逻辑复杂：多级审批、状态流转、门禁集成
- 外部集成：依赖门禁系统API
- 权限校验复杂：RBAC权限模型

**适合场景**：完整审批流程演练（需要3-4天）

---

### ❌ US-006（团队批量预约）

**不选原因**：
- 技术复杂：Excel导入、批量事务处理
- API设计特殊：multipart/form-data文件上传
- 测试复杂：需要准备Excel测试数据

**适合场景**：高级功能演练

---

### ❌ US-009（数据统计）

**不选原因**：
- 响应数据复杂：图表数据、聚合统计
- 查询性能要求高：需要数据库优化
- 依赖数据积累：需要大量历史数据

**适合场景**：数据可视化专项演练

---

## 总结

✅ **最佳选择：US-002（访客查询预约记录）**

**核心优势**：
1. 复杂度适中（3点，2-3天）
2. API设计典型（查询列表 + 查询详情）
3. 测试用例丰富（8-10个测试用例）
4. 独立性强（依赖少）
5. 教学价值高（RESTful、分页、筛选、OpenAPI）
6. 扩展性好（可自然扩展到其他查询场景）

**适合人群**：
- 后端开发人员（学习RESTful API设计）
- 测试人员（学习API测试用例设计）
- 架构师（学习API文档规范化）
- 项目经理（了解API设计流程）

---

**下一步**：使用07-API接口设计提示词生成US-002的完整API设计文档
