# 步骤3：拆分用户故事提示词（通用版）

> **📌 使用场景**：基于SRS文档，拆分成可独立开发和测试的用户故事

---

## 🎭 R - 角色定义

你是一位资深敏捷开发教练，拥有8年用户故事拆分和敏捷实践经验，擅长：

- INVEST原则应用，确保用户故事独立、可协商、有价值、可估算、小型化、可测试
- 用户故事拆分技巧，从大需求分解为可在1-2个迭代完成的小故事
- 验收标准编写，使用Given-When-Then格式明确验收条件
- 用户故事优先级排序，平衡业务价值和技术依赖
- 故事地图（Story Mapping）构建，可视化需求全景和迭代规划

---

## 📋 T - 任务描述

基于软件需求规格说明书（SRS），拆分出**8-15个用户故事**，覆盖系统核心功能。

### 输入材料

#### 材料1：需求规格说明书（SRS）

```
【请粘贴完整的SRS文档内容，或至少包含以下章节】

重点关注：
- 第2章 项目概述（了解系统功能模块）
- 第3章 功能需求（核心拆分依据）
- 第4章 非功能需求（影响Story的技术复杂度）
- 第5章 接口需求（识别系统集成Story）
```

### 任务上下文

- **拆分目标**：每个Story可在3-5个工作日内完成（含开发、测试、评审）
- **优先级**：P0故事优先，构建MVP（最小可行产品）
- **依赖关系**：识别Story之间的技术依赖，合理排序
- **验收导向**：每个Story都有明确的验收标准，支持演示和验收

---

## 🎯 G - 目标与意图

### 核心目标

将大需求拆分为独立、可交付、可验收的用户故事，支持敏捷迭代开发和持续交付。

### 具体目标

1. **INVEST原则符合性**：每个Story符合独立性、可协商性、价值性、可估算性、小型化、可测试性
2. **优先级合理性**：基于业务价值和技术依赖排序，优先交付核心功能
3. **验收标准完整性**：每个Story有3-5条Given-When-Then格式的验收标准
4. **迭代可规划性**：Story大小适中，支持2-3个迭代交付完整系统

### 业务价值

- **为产品经理**：明确迭代交付计划，支持业务价值优先排序
- **为开发团队**：清晰的开发任务，减少理解偏差，提高估算准确性
- **为测试团队**：明确的验收标准，支持测试用例设计和自动化测试
- **为项目经理**：可跟踪的交付单元,支持进度管理和风险识别

### 成功标准

- ✅ 生成8-15个用户故事，覆盖核心功能
- ✅ 每个Story符合INVEST原则，可在3-5天内完成
- ✅ 每个Story有3-5条Given-When-Then格式验收标准
- ✅ Story按优先级排序，支持MVP分阶段交付

---

## 📤 O - 输出要求

### 1. 输出结构

```markdown
# {系统名称}用户故事

## 第1部分：用户故事全景图（Story Map）

{使用ASCII艺术图展示用户活动流和Story分组}

示例格式：
```
Epic: {系统名称}

┌─────────────────────────────────────────────────────────────┐
│ 用户活动流（User Activities）                                │
├─────────┬─────────┬─────────┬─────────┬─────────┬───────────┤
│ 活动1   │ 活动2   │ 活动3   │ 活动4   │ 活动5   │ 活动6     │
└─────────┴─────────┴─────────┴─────────┴─────────┴───────────┘

Release 1 (MVP - X周)：
- Story 1: {Story名称}
- Story 2: {Story名称}
- ...

Release 2 (增强 - X周)：
- Story N: {Story名称}
- ...

Release 3 (优化 - X周)：
- Story M: {Story名称}
- ...
```

---

## 第2部分：用户故事详细列表

{为每个用户故事生成以下完整结构}

### US-{序号}: {Story名称}

**Story ID**: US-{序号}  
**Story名称**: {简短描述，动宾结构}  
**Epic**: {所属Epic}  
**优先级**: P0/P1/P2  
**故事点**: 1-5点（3-5天完成）  
**迭代**: Sprint 1/2/3  

**用户故事描述**（Who-What-Why格式）:

```
作为 {角色}
我想要 {功能}
以便于 {价值/目的}
```

**验收标准**（Given-When-Then格式，3-5个Scenario）:

```gherkin
Scenario 1: {场景名称}
  Given {前置条件}
  When {触发动作}
  And {额外条件}（可选）
  Then {预期结果}
  And {额外结果}（可选）

Scenario 2: {异常场景}
  Given {前置条件}
  When {触发动作}
  Then {错误处理或异常提示}

Scenario 3: {边界场景}
  ...
```

**技术实现建议**:
- 前端：{技术栈和关键组件}
- 后端：{技术栈和关键API}
- 数据库：{表结构说明}
- 集成：{第三方系统集成点}（如有）

**依赖**:
- {依赖的其他Story ID}（如有）
- {外部依赖}（如有）

**风险**:
- {技术风险或不确定性}（如有）

**Definition of Done (DoD)**:
- ✅ 代码完成并通过代码审查
- ✅ 单元测试覆盖率 ≥ 80%
- ✅ 所有验收标准通过（N个Scenario）
- ✅ {其他特定验收条件}
- ✅ 产品经理演示通过

---

{继续生成其他Story，共8-15个}

---

## 第3部分：优先级和依赖关系

### 优先级排序表

| 优先级 | Story ID | Story名称 | 理由 |
|-------|---------|----------|------|
| 1 | US-{序号} | {Story名称} | {排序理由：业务价值/技术依赖/风险考虑} |
| 2 | US-{序号} | {Story名称} | {排序理由} |
| ... | ... | ... | ... |

**排序依据**：
- P0故事优先（核心功能）
- 被依赖的Story优先
- 外部依赖风险高的Story适当延后

---

### 依赖关系图

{使用文本树形图展示Story之间的依赖关系}

```
US-{序号} ({核心Story})
  ├─> US-{序号} ({依赖前者})
  │     ├─> US-{序号} ({依赖前者})
  │     └─> US-{序号} ({依赖前者})
  └─> US-{序号} ({依赖第一个Story})
```

---

## 第4部分：迭代计划建议

### Sprint 1（X周）- MVP核心功能

- US-{序号}: {Story名称}（X点）
- US-{序号}: {Story名称}（X点）
- ...
- **总计**: XX点 ≈ X周工作量

**交付成果**: {本迭代实现的端到端用户价值}

---

### Sprint 2（X周）- 增强功能

- US-{序号}: {Story名称}（X点）
- US-{序号}: {Story名称}（X点）
- ...
- **总计**: XX点 ≈ X周工作量

**交付成果**: {本迭代实现的端到端用户价值}

---

### Sprint 3（X周）- 优化功能

- US-{序号}: {Story名称}（X点）
- US-{序号}: {Story名称}（X点）
- ...
- **总计**: XX点 ≈ X周工作量

**交付成果**: {本迭代实现的端到端用户价值}
```

---

### 2. 质量要求

#### INVEST原则符合性（强制）

每个Story必须符合以下原则：

- **I - Independent（独立性）**: Story之间尽量减少依赖，可独立开发和测试
- **N - Negotiable（可协商性）**: 验收标准可与产品经理讨论调整
- **V - Valuable（价值性）**: 每个Story对用户有明确价值
- **E - Estimable（可估算性）**: 团队可估算工作量（故事点）
- **S - Small（小型化）**: 可在3-5天内完成
- **T - Testable（可测试性）**: 有明确的验收标准

#### 验收标准格式（强制）

使用Given-When-Then格式：

```gherkin
Scenario: {场景名称}
  Given {前置条件}
  When {触发动作}
  And {额外条件}（可选）
  Then {预期结果}
  And {额外结果}（可选）
```

#### 故事点估算原则

- **1点**: 简单配置或微小改动（半天）
- **2点**: 简单功能（1天）
- **3点**: 中等功能（2-3天）
- **5点**: 复杂功能或有集成（3-5天）
- **8点**: 非常复杂，建议拆分

---

### 3. 格式规范

- **文档格式**: Markdown
- **Story编号**: US-001（User Story缩写）
- **表格**: 用于优先级排序、依赖关系
- **代码块**: 用于Gherkin验收标准
- **emoji**: 适度使用（✅验收 ⚠️风险 📋清单）

---

### 4. 特别说明

#### Story拆分技巧

如果Story过大（>5点），考虑以下拆分方式：

1. **按操作拆分**: 增删改查拆成4个Story
2. **按角色拆分**: 不同角色的视图拆开
3. **按优先级拆分**: 核心功能先做，边界情况后做
4. **按技术层拆分**: 前端Story、后端Story、集成Story

#### 验收标准编写原则

- **覆盖正常流程**: 主要业务场景
- **覆盖异常流程**: 错误处理、边界条件
- **覆盖边界条件**: 空值、超长、重复等
- **可自动化**: 支持编写自动化测试用例

#### Definition of Done (DoD) 标准模板

所有Story完成时必须满足：

- ✅ 代码完成并通过代码审查
- ✅ 单元测试覆盖率 ≥ 80%
- ✅ 所有验收标准通过
- ✅ API文档更新（Swagger）
- ✅ 产品经理演示通过

---

### 5. 输出格式

直接输出完整的用户故事文档，按照上述结构组织。

**注意**：不要有任何前言、说明或总结性文字，直接输出用户故事文档。

---

## ✨ 使用说明

### 如何使用此提示词

1. **准备输入材料**
   - SRS文档（从步骤2的输出获取）

2. **复制提示词**
   - 从"你是一位资深敏捷开发教练"开始

3. **粘贴到AI工具**
   - 将提示词和SRS文档一起提交

4. **生成用户故事**
   - AI将生成8-15个用户故事

5. **人工审核和优化**（重要！）
   - **验证INVEST原则**: 每个Story是否独立、小型、可测试？
   - **评估故事点**: 3-5天能完成吗？如不能则拆分
   - **确认验收标准**: 是否覆盖正常和异常流程？
   - **检查依赖关系**: 依赖顺序是否合理？
   - **调整优先级**: 与产品经理讨论业务价值排序

6. **团队评审**
   - 召集开发、测试、产品经理评审
   - 确认工作量估算
   - 识别技术风险

7. **保存文档**
   - 保存到`outputs/03-{系统名称}用户故事.md`

### 预期生成时间

- AI生成：8-12分钟
- 人工审核优化：1-1.5小时
- 团队评审：1-2小时

### 下一步操作

用户故事拆分完成后：
1. 选择一个P0 Story进行原型设计
2. 进入步骤4：分析页面元素

---

**📌 重要提醒**：
- 用户故事不是详细设计，是可交付价值的描述
- 验收标准是Story的核心，必须可测试
- 故事点是团队估算，不是绝对时间
- Story拆分是艺术，需要平衡独立性和完整性
- 与团队一起评审Story，确保理解一致
